<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <title>DERMS PWA</title>

  <link rel="shortcut icon" href="icons/icon-128x128.png" />
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="apple-touch-icon" href="icons/icon-512x512.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <meta name="apple-mobile-web-app-title" content="DERMS PWA" />
  <meta name="theme-color" content="#39c16c" />
  <meta name="description" content="DERMS PWA with React" />

</head>

<body>
  <!-- Bootstrap CSS CDN - Disable if performance is bad -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous" />

  <!-- Leaflet map css -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
    integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
    crossorigin="" />

  <!-- Leaflet location control css -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol/dist/L.Control.Locate.min.css">

  <!-- Leaflet Geocoder CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />

  <!-- TODO: Move these CDNs to their components' JSX files? -->
  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <!-- <script src="https://www.gstatic.com/firebasejs/7.11.0/firebase-app.js"></script> -->

  <!-- TODO: Add SDKs for Firebase products that you want to use
   https://firebase.google.com/docs/web/setup#available-libraries -->
  <!-- <script src="https://www.gstatic.com/firebasejs/7.11.0/firebase-analytics.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.11.0/firebase-messaging.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.11.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.11.0/firebase-database.js"></script> -->

  <div id="notification" style="display: none">A new version of this app is available. Click <a id="reload">here</a> to update.</div>

  <noscript>You need to enable JavaScript to run this app.</noscript>
  <div id="root"></div>
  <script src="../src/index.js"></script>

  <script>
    let newWorker;
    // The click event on the notification
    document.getElementById('reload').addEventListener('click', function () {
      newWorker.postMessage({ action: 'skipWaiting' });
    });

    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('serviceWorker.js').then(reg => {
          reg.addEventListener('updatefound', () => {

            // An updated service worker has appeared in reg.installing!
            newWorker = reg.installing;

            newWorker.addEventListener('statechange', () => {

              // Has service worker state changed?
              switch (newWorker.state) {
                case 'installed':

                  // There is a new service worker available, show the notification
                  if (navigator.serviceWorker.controller) {
                    let notification = document.getElementById('notification ');
                    notification.className = 'show';
                  }

                  break;
              }
            });
          });
        });
      });
    }


    let refreshing;
    // The event listener that is fired when the service worker updates
    // Here we reload the page
    navigator.serviceWorker.addEventListener('controllerchange', function () {
      if (refreshing) return;
      window.location.reload();
      refreshing = true;
    });
  </script>
</body>

</html>